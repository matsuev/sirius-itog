# Итоговая проверочная работа

---

#### Демонстрационное задание

* Все исполняемые файлы расположены в папке ./bin
* Файлы Frontend-приложения расположены в папке ./frontend

---

!!! ВАЖНОЕ ЗАМЕЧАНИЕ:
В выражение **map** конфигурации NGINX необходимо добавить опцию **hostnames;**

Пример:
```
map $http_x_rpc_method $target_service {
   hostnames;

   user.*  user-service;
   default core-service;
}
```
---
1. В Docker Compose нужно сконфигурировать следующую инфраструктуру:
   * loadbalancer - роутер/балансировщик нагрузки
   * core-service - контейнер с запущенным сервисом ./bin/core-service
   * math-service - контейнер с запущенным сервисом ./bin/math-service

2. loadbalancer должен отвечать на запросы по адресу http://127.0.0.1:8080 (внутри контейнера сервис использует порт :80)

3. Сервисы __core-service__ и __math-service__ должны быть доступны только внутри Compose и принимать подключения на порту __:80__

4. Запрос по адресу __http://127.0.0.1:8080__ должен возвращать стартовую страницу frontend приложения. Файлы веб приложения расположены в папке ./frontend. Необходимо смонтировать эту папку в контейнер и настроить правило маршрутизации для __location /__

5. Запросы по адресу __http://127.0.0.1:8080/rpc__ должны возвращать результаты вызовов к микросервисам __core-service__ и __math-service__

6. Правила RPC протокола:
   * Максимальный размер пакета - 4096 байт
   * Время выполнения запроса - 1 секунда
   * Запросы только методом POST
   * В запросе должны присутствовать следующие заголовки:
     * X-Client-ID: sirius-frontend
     * X-Client-Secret: <любая строка>
     * X-Rpc-Method: <math.*>
   * Тело запроса должно приходить в формате JSON

7. Правила маршрутизации запросов для __location /rpc__
   * Все запросы удовлетворяющие правилу __math.*__ проксируются в сервис __math-service__
   * Все остальные запросы просируются в __core-service__